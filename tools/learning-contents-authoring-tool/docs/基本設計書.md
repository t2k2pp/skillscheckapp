# 基本設計書 - 学習コンテンツ管理ツール

## 1. 概要

本ドキュメントは、「要求仕様書」に基づき、「学習コンテンツ管理ツール」の基本的なシステム設計を定義するものである。

## 2. システムアーキテクチャ

本システムは、ユーザーのローカルマシン上で動作するクライアントサーバーモデルを採用する。

- **フロントエンド (クライアント):**
  - Reactを利用したシングルページアプリケーション(SPA)として構築する。
  - ユーザーインターフェースを提供し、ユーザー操作を受け付ける。
  - バックエンドAPIとHTTP通信（Ajax）を行い、データの取得や更新を要求する。

- **バックエンド (サーバー):**
  - Node.jsおよびExpressフレームワークを利用したAPIサーバーとして構築する。
  - フロントエンドからのリクエストに応じて、サーバーのローカルファイルシステム上にあるJSONファイルや画像ファイルの読み込み、書き込み、削除を行う。

- **データストア:**
  - サーバーのローカルファイルシステムをデータストアとして利用する。
  - 学習コンテンツのデータはすべてJSON形式のファイルで、画像はPNGなどのファイル形式で直接格納される。

![System Architecture](https://i.imgur.com/9qYAFk1.png)

## 3. 使用技術 (技術スタック)

| 層             | 技術・ライブラリ        |
|----------------|-------------------------|
| フロントエンド | React, TypeScript, Vite, Tailwind CSS |
| バックエンド   | Node.js, Express.js     |
| サーバー実行   | `fs`, `path`, `cors`, `multer` |
| 開発環境       | npm, concurrently (過去に使用) |

## 4. データフロー

### 4.1. 一覧表示
1.  **フロントエンド:** `IndexScreen`コンポーネントがマウントされる。
2.  **フロントエンド:** バックエンドの`/api/question-sets`エンドポイントにGETリクエストを送信する。
3.  **バックエンド:** リクエストを受け取り、設定ファイル(`config.json`)で指定されたパスにある`index.json`を読み込む。
4.  **バックエンド:** `index.json`の内容をJSON形式でフロントエンドにレスポンスとして返す。
5.  **フロントエンド:** 受け取ったJSONデータをReactのstateに格納し、画面にコンテンツ一覧を描画する。

### 4.2. コンテンツ保存 (編集・新規)
1.  **フロントエンド:** `EditorScreen`でユーザーが「保存」ボタンをクリックする。
2.  **フロントエンド:** 現在の編集内容(Reactのstate)をJSONオブジェクトとして、バックエンドの`/api/question-sets/:filename`エンドポイントにPOSTリクエストを送信する。
3.  **バックエンド:** リクエストを受け取り、JSONデータを文字列に変換して、対応する`<id>.json`ファイルに上書き保存する。
4.  **バックエンド:** (新規作成の場合) `index.json`を読み込み、新しいコンテンツのメタデータを追記して保存し直す。
5.  **バックエンド:** 保存成功のメッセージをフロントエンドに返す。
6.  **フロントエンド:** 成功メッセージを受け取り、一覧画面に戻る。
